<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@7.3.0/ol.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="styles.css">
    <title>WebGIS Catastro de Afectaciones por Marejadas</title>
</head>
<body>
    <div class="container">
      <nav class="navbar navbar-fixed-top navbar-default" role="navigation">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">WebGIS - Catastro de Marejadas</a>
          </div>
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
              <li class="active"><a href="#">Inicio</a></li>
              <li><a href="#">Acerca de</a></li>
              <li><a href="#">Contacto</a></li>
            </ul>
            <form class="navbar-form navbar-left" role="search" id="search-form">
              <div class="form-group">
                <input type="text" class="form-control" id="search-input" placeholder="Buscar ubicación...">
              </div>
              <button type="submit" class="btn btn-default">Buscar</button>
              <button type="button" class="btn btn-primary" id="current-location-btn" style="margin-left: 5px;" title="Mi ubicación actual">
                  <i class="fa fa-location-arrow"></i>
              </button>
            </form>
            </div>
            </div>
          </nav>
        </div>
      
      <div class="navbar-offset"></div>
      <div id="map">
        <!-- Leyenda integrada en el mapa -->
        <div id="legend">
          <h4>Leyenda - Nivel de Urgencia</h4>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #e74c3c;"></div>
            <span>Alta Urgencia (Nivel 3)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #f39c12;"></div>
            <span>Media Urgencia (Nivel 2)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #f1c40f;"></div>
            <span>Baja Urgencia (Nivel 1)</span>
          </div>
        </div>
      </div>
      
      <div class="row main-row">
        <div class="col-sm-4 col-md-3 sidebar sidebar-left pull-left">
          <div class="panel-group sidebar-body" id="accordion-left" style="display: block;">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h4 class="panel-title">
                  <a data-toggle="collapse" href="#filters-panel">
                    <i class="fa fa-filter"></i>
                    Filtros
                  </a>
                  <span class="pull-right slide-submenu">
                    <i class="fa fa-chevron-left"></i>
                  </span>
                </h4>
              </div>
              <div id="filters-panel" class="panel-collapse collapse in">
                <div class="panel-body">
                  <form id="filter-form">
                    <div class="filter-group">
                      <label for="filter-type">Tipo de Afectación:</label>
                      <select id="filter-type">
                        <option value="">Todos</option>
                        <option value="inundacion_vereda">Inundación de vereda</option>
                        <option value="inundacion_calle">Inundación de calle</option>
                        <option value="inundacion_vivienda">Inundación de viviendas/comercio</option>
                        <option value="danos_infraestructura">Daño a infraestructura costera</option>
                        <option value="erosion">Erosión o socavón</option>
                        <option value="otro">Otro</option>
                      </select>
                    </div>
                    
                    <div class="filter-group">
                      <label for="filter-urgency">Nivel de Urgencia:</label>
                      <select id="filter-urgency">
                        <option value="">Todos</option>
                        <option value="Alto">Alto</option>
                        <option value="Medio">Medio</option>
                        <option value="Bajo">Bajo</option>
                      </select>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-block">Aplicar Filtros</button>
                    <button type="button" id="reset-filters" class="btn btn-default btn-block" style="margin-top: 5px;">
                      Limpiar Filtros
                    </button>
                  </form>
                </div>
              </div>
            </div>
            
            <div class="panel panel-default">
              <div class="panel-heading">
                <h4 class="panel-title">
                  <a data-toggle="collapse" href="#statistics-panel">
                    <i class="fa fa-bar-chart"></i>
                    Estadísticas
                  </a>
                </h4>
              </div>
              <div id="statistics-panel" class="panel-collapse collapse in">
                <div class="panel-body">
                  <div class="stat-item">
                    <strong>Total de Reportes:</strong> <span id="total-reports" class="stat-value">0</span>
                  </div>
                  <div class="stat-item">
                    <strong>Alta Urgencia:</strong> <span id="high-urgency" class="stat-value">0</span>
                  </div>
                  <div class="stat-item">
                    <strong>Media Urgencia:</strong> <span id="medium-urgency" class="stat-value">0</span>
                  </div>
                  <div class="stat-item">
                    <strong>Baja Urgencia:</strong> <span id="low-urgency" class="stat-value">0</span>
                  </div>
                  <hr>
                  <div class="stat-item">
                    <strong>Inund. Vereda:</strong> <span id="inundacion-vereda" class="stat-value">0</span>
                  </div>
                  <div class="stat-item">
                    <strong>Inund. Calle:</strong> <span id="inundacion-calle" class="stat-value">0</span>
                  </div>
                  <div class="stat-item">
                    <strong>Inund. Vivienda:</strong> <span id="inundacion-vivienda" class="stat-value">0</span>
                  </div>
                  <div class="stat-item">
                    <strong>Daños Infraestructura:</strong> <span id="danos-infraestructura" class="stat-value">0</span>
                  </div>
                  <div class="stat-item">
                    <strong>Erosión/Socavón:</strong> <span id="erosion" class="stat-value">0</span>
                  </div>
                  <div class="stat-item">
                    <strong>Otro:</strong> <span id="otro" class="stat-value">0</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="panel panel-default">
              <div class="panel-heading">
                <h4 class="panel-title">
                  <a data-toggle="collapse" href="#kobo-panel">
                    <i class="fa fa-plus-circle"></i>
                    Realizar Reporte
                  </a>
                </h4>
              </div>
              <div id="kobo-panel" class="panel-collapse collapse in">
                <div class="panel-body">
                  <p>Para reportar una nueva afectación por marejadas:</p>
                  <button id="open-kobo-form" class="btn-kobo">Abrir Formulario Kobo</button>
                  <p style="font-size: 12px; margin-top: 10px; color: #666;">
                    El formulario se abrirá en una nueva ventana/tab.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="mini-submenu mini-submenu-left pull-left" style="display: none;">
        <i class="fa fa-bars"></i>
      </div>
    </div>

    <!-- Scripts -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/ol@7.3.0/dist/ol.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="app.js"></script>
</body>
</html>